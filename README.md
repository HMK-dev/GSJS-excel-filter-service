# 국민연금 & 강소기업 데이터 처리 프로그램

이 프로그램은 **강소기업 명단 엑셀**과 **국민연금 가입 사업장 엑셀**을 비교 및 결합하여 데이터 분석을 돕는 프로그램입니다.

## 프로그램 개요

이 프로그램을 통해 다음과 같은 작업을 수행할 수 있습니다:

1. **국민연금 데이터에서 강소기업만 추출**: 사업자등록번호를 기준으로 국민연금 데이터에서 강소기업만 필터링합니다.
2. **국민연금 데이터의 소재지를 강소기업 엑셀로 복사**: 국민연금 데이터의 상세 주소를 강소기업 엑셀의 소재지 정보에 업데이트합니다.

## 폴더 구조

프로그램이 정상적으로 동작하기 위해서는 다음과 같은 폴더 구조가 필요합니다:

```
프로젝트_루트/
├── data/
│   ├── company_data/   # 강소기업 데이터 파일이 위치하는 폴더
│   └── pension_data/   # 국민연금 데이터 파일이 위치하는 폴더
├── output/             # 처리 결과가 저장되는 폴더
└── company_filter.py             # 실행 파일
```

## 사용 방법

1. 프로그램 실행:
   ```
   python main.py
   ```

2. 메인 메뉴에서 실행할 작업을 선택합니다:
   ```
   📊 실행할 작업을 선택하세요:
   1: 국민연금 데이터에서 강소기업만 추출
   2: 국민연금 데이터의 소재지를 강소기업 엑셀로 복사
   q: 종료
   ```

### 옵션 1: 국민연금 데이터에서 강소기업만 추출

1. 강소기업 엑셀 파일명을 입력합니다. (예: `강소기업_명단.xlsx`)
2. 처리 방식을 선택합니다:
   - `1`: 단일 국민연금 파일 처리
   - `2`: 여러 국민연금 파일 일괄 처리
3. 단일 파일 처리 시 국민연금 엑셀 파일명을 입력합니다. (예: `국민연금_202401.xlsx`)
4. 저장할 출력 파일명을 입력합니다. (예: `filtered_202401.xlsx`)
5. 완료 메시지가 표시되면 `output` 폴더에서 결과 파일을 확인할 수 있습니다.

### 옵션 2: 국민연금 데이터의 소재지를 강소기업 엑셀로 복사

1. 강소기업 엑셀 파일명을 입력합니다. (예: `강소기업_명단.xlsx`)
2. 국민연금 엑셀 파일명을 입력합니다. (예: `국민연금_202401.xlsx`)
3. 저장할 출력 파일명을 입력합니다. (예: `updated_location.xlsx`)
4. 완료 메시지가 표시되면 `output` 폴더에서 결과 파일을 확인할 수 있습니다.

## 데이터 형식 요구사항

### 강소기업 엑셀
- 반드시 `사업자등록번호` 열이 포함되어 있어야 합니다.
- 주소 업데이트를 위해서는 `소재지` 열이 있어야 합니다.

### 국민연금 엑셀
- 반드시 `BZOWR_RGST_NO` (사업자등록번호) 열이 포함되어 있어야 합니다.
- 주소 업데이트를 위해서는 `WKPL_LTNO_DTL_ADDR` (사업장 주소) 열이 있어야 합니다.

## 주의사항

- 사업자등록번호는 숫자와 하이픈(-)으로 구성되어 있어야 하며, 내부적으로 하이픈을 제거하여 비교합니다.
- 모든 데이터는 문자열(string)로 처리되므로 숫자 형식의 데이터가 있어도 문제없이 동작합니다.
- 처리할 파일이 해당 폴더에 미리 배치되어 있어야 합니다.

## 오류 해결

- 파일을 찾을 수 없는 경우: 파일명이 정확한지, 해당 폴더에 파일이 있는지 확인하세요.
- 열 이름이 맞지 않는 경우: 엑셀 파일에 필요한 열(사업자등록번호, 소재지 등)이 존재하는지 확인하세요.